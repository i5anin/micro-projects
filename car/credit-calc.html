<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ö—Ä–µ–¥–∏—Ç–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
    <h1 class="mb-4">üìä –†–∞—Å—á—ë—Ç –∞–Ω–Ω—É–∏—Ç–µ—Ç–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞</h1>

    <form id="form" class="row g-3">
        <div class="col-md-6">
            <label class="form-label">üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –∞–≤—Ç–æ</label>
            <input type="number" class="form-control" id="price" value="2894190" required>
        </div>
        <div class="col-md-6">
            <label class="form-label">üíµ –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å (%)</label>
            <input type="number" class="form-control" id="initialPercent" value="70" required>
        </div>
        <div class="col-md-6">
            <label class="form-label">üìÜ –°—Ä–æ–∫ –∫—Ä–µ–¥–∏—Ç–∞ (–º–µ—Å.)</label>
            <input type="number" class="form-control" id="months" value="36" required>
        </div>
        <div class="col-md-6">
            <label class="form-label">üìà –°—Ç–∞–≤–∫–∞ (% –≥–æ–¥–æ–≤—ã—Ö)</label>
            <input type="number" step="0.0001" class="form-control" id="annualRate" value="0.01" required>
        </div>
        <div class="col-md-6">
            <label class="form-label">üõ° –ö–ê–°–ö–û</label>
            <input type="number" class="form-control" id="casco" value="70000" required>
        </div>
        <div class="col-md-6">
            <label class="form-label">üìÑ –§–∏–Ω–ø—Ä–æ–¥—É–∫—Ç—ã</label>
            <input type="number" class="form-control" id="financial" value="60000" required>
        </div>
        <div class="col-12">
            <button type="submit" class="btn btn-primary">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
        </div>
    </form>

    <div id="output" class="mt-5"></div>
</div>

<script>
    const format = n => n.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ' ') + ' ‚ÇΩ';

    document.getElementById("form").addEventListener("submit", function (e) {
        e.preventDefault();

        const price = +document.getElementById("price").value;
        const initialPercent = +document.getElementById("initialPercent").value;
        const months = +document.getElementById("months").value;
        const annualRate = +document.getElementById("annualRate").value;
        const casco = +document.getElementById("casco").value;
        const financial = +document.getElementById("financial").value;

        const downPayment = price * initialPercent / 100;
        const creditBody = price - downPayment;
        const totalLoan = creditBody + casco + financial;

        const r = (annualRate / 100) / 12;
        const numerator = r * Math.pow(1 + r, months);
        const denominator = Math.pow(1 + r, months) - 1;
        const k = numerator / denominator;

        const monthly = totalLoan * k;
        const flatMonthly = totalLoan / months;
        const overpayment = monthly * months - totalLoan;

        const output = `
        <div class="card shadow-sm">
          <div class="card-body">
            <h2 class="card-title mb-4">üìå –§–æ—Ä–º—É–ª—ã –∏ —Ä–∞—Å—á—ë—Ç—ã</h2>

            <ul class="list-group list-group-flush mb-3">
              <li class="list-group-item">üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –∞–≤—Ç–æ: <strong>${format(price)}</strong></li>
              <li class="list-group-item">üíµ –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å (70%): <strong>${format(downPayment)}</strong></li>
              <li class="list-group-item">üìâ –¢–µ–ª–æ –∫—Ä–µ–¥–∏—Ç–∞: <strong>${format(creditBody)}</strong></li>
              <li class="list-group-item">‚ûï –ö–ê–°–ö–û –∏ —Ñ–∏–Ω–ø—Ä–æ–¥—É–∫—Ç—ã: <strong>${format(casco + financial)}</strong></li>
              <li class="list-group-item">üí≥ –°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞: <strong>${format(totalLoan)}</strong></li>
            </ul>

            <h5 class="mt-4">üìà –ê–Ω–Ω—É–∏—Ç–µ—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:</h5>
            <p><code>k = r √ó (1 + r)^n / ((1 + r)^n ‚Äì 1)</code></p>
            <p><code>r = ${r.toFixed(8)}</code>, <code>n = ${months}</code>, <code>k = ${k.toFixed(10)}</code></p>

            <h5 class="mt-4">üí≥ –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂:</h5>
            <p><code>–ü–ª–∞—Ç—ë–∂ = ${format(totalLoan)} √ó ${k.toFixed(10)} = <strong>${format(monthly)}</strong></code></p>

            <h5 class="mt-4">üìé –°—Ä–∞–≤–Ω–µ–Ω–∏–µ:</h5>
            <p>–ü–ª–∞—Ç—ë–∂ –±–µ–∑ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤: <strong>${format(flatMonthly)}</strong></p>

            <div class="alert alert-info mt-4">
              üìÑ <strong>–ü–µ—Ä–µ–ø–ª–∞—Ç–∞ –∑–∞ –≤–µ—Å—å —Å—Ä–æ–∫: ${format(overpayment)}</strong>
            </div>
          </div>
        </div>
      `;

        document.getElementById("output").innerHTML = output;
    });
</script>
</body>
</html>
